# MLC-for-Android-Malware

We propose a ML-based multi-label classification approach for Android malicious behavior analysis in order to break through the limitation of inaccurate and insufficient information for subsequent analysis, which exists in both binary and family classification. To achieve this, we first summarize 6 types of basic malicious behaviors with an in-depth analysis on 180 malware with security reports. Sepciffly, these 6 types are "**SMS-related**", "**Internet-related**", "**Telephony-related**", "**Lock-in**", "**Ads**", and "**Re-infection**".

### Directory Structure
The repository provides .pkl files, test sets, labeled dataset and test code, which can be used for reproducing the results of experiments in Multi-label Classification for Android Malware
Based on Active Learning. The following table presents the directory structure.

<table>
  <tr>
    <td rowspan="7">model</td>
    <td colspan="2">base model</td>
    <td>Here are 10 .pkl files of base model.</td> 
  </tr>
  <tr>
    <td rowspan="3">DREBIN</td>
    <td>Detection-Training</td>
    <td>Here are 10 .pkl files after data augmentation with batch size 8 on DREBIN.</td>
  </tr>
  <tr>
    <td>barch_size_N</td>
    <td>Here are 15 .pkl files after data augmentation with batch size 4,16,32 of 5 methods on DREBIN.</td>
  </tr>
  <tr>
    <td>Evaluation_of_models</td>
    <td>Here are 5 .pkl files after evaluating the add data on DREBIN.</td>
  </tr>
  <tr>
    <td rowspan="3">VirusShare</td>
    <td>Detection-Training</td>
    <td>Here are 10 .pkl files after data augmentation with batch size 8 on VirusShare.</td>
  </tr>
  <tr>
    <td>barch_size_N</td>
    <td>Here are 15 .pkl files after data augmentation with batch size 4,16,32 of 5 methods on VirusShare.</td>
  </tr>
  <tr>
    <td>Evaluation_of_models</td>
    <td>Here are 5 .pkl files after evaluating the add data on VirusShare.</td>
  </tr>
   <tr>
    <td rowspan="2">labeled_dataset</td>
    <td colspan="2">Samples</td>
    <td>180 apks in labeled dataset.</td>
  </tr>
  <tr>
    <td colspan="2">Label infos</td>
    <td>The label infos of 180 samples.</td>
  </tr>
  <tr>
    <td rowspan="2">test_set</td>
    <td colspan="2">manual_test.arff</td>
    <td>The test set for 'base_model', 'Detection-Training' and 'barch_size_N'.</td>
  </tr>
  <tr>
    <td colspan="2">test_for_evaluation.arff</td>
    <td>The test set for 'Evaluation_of_models'.</td>
  </tr>
</table>

### Dependency
- python version:3.8.5
- jdk-17.0.1
- [meka-release-1.9.2](https://github.com/Waikato/meka/releases/tag/meka-1.9.2)
- pip install numpy==1.19.5
- pip install liac-arff==2.5.0
- pip install requests==2.26.0
- pip install joblib==0.17.0
- pip install scikit-learn==0.23.2

### Quickly Run 
Here, we give an example to run test_code.py quickly.
```shell
python test_code.py --meka_path /home/meka-release-1.9.2/lib/ --java_path /home/jdk-17.0.1/bin/java --model_path ./model/base_model/CDN_J48.pkl --test_path ./test_set/manual_test.arff
```
The parameters are as followsï¼š
<table>
  <tr>
    <td>--meka_path</td>
    <td>The path of your meka.</td>
  </tr>
  <tr>
    <td>--java_path</td>
    <td>The path of your java.</td>
  </tr>
  <tr>
    <td>--model_path</td>
    <td>The model path you want to load and run.</td>
  </tr>
  <tr>
    <td>--test_path</td>
    <td>The path of your test set.</td>
  </tr>
</table>

### Reference
This repo provides the pre-trained models with test scripts and vector set for the experiments in the following paper (under peer reviewing).
```
@article{"MLC2021",
title={Multi-label Classification for Android Malware Based on Active Learning},
author={Q. Qiao,R. Feng,S. Chen,F. Zhang,X. Li},
year=2022
}
```
